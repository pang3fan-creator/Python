<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>222::知库管理平台</title>
    <link rel="stylesheet" href="{% static 'frontend/styles/reset.css' %}">
    <link rel="stylesheet" href="{% static 'frontend/styles/article.css' %}">
    <style type="text/css">
        .btn-disabled {
            cursor: not-allowed  !important;
            color: #f5f5f5;
            background: #999 !important;
        }
    </style>
</head>
<body>
    {% include 'frontend/include/header.html' %}
    <main>
        <header class="article-header">
            <h2 class="article-title">{{ article.subject }}</h2>
            <p>{{ article.author.nickname }} {{ article.created_at|date:'Y-m-d H:i' }}</p>
        </header>
		<article class="article-content">			
		      {{ article.content|safe }}	
		</article>
		<div id="comment-list">
            <div class="comment-form">
                <div class="hd clearfix">
                    <div class="wrap-title">网友评论</div>
                    <div class="count"><em>{{ article.comment_set.count }}</em>条评论</div>
                </div>
                <div class="bd clearfix">
                    <div class="user-head" style="text-align: center;">
                        <a href="#">
                            
                           
                            <img src="{{ MEDIA_URL|add:'frontend/avatar/male_180.png' }}" alt="">
                            <div>张三</div>
                        </a>
                    </div>
                    <div class="editor">
                        <div class="inner">
                            <textarea name="" id="" class="box"></textarea>
                        </div>
                    </div>
                    <div class="ft clearfix">
                        <div class="right-actions clearfix">
                            <a href="#" class="comment-btn commit-comment">发布</a>
                            <!--
                            <a id="button1" href="/comment/{{ article.pk }}/" class="comment-btn all-comments">所有评论</a>
                            <a id="button2" href="javascript:void(0)" class="comment-btn btn-disabled">所有评论</a>
                            -->
                            <a href="{% if article.comment_set.count %}/comment/{{ article.pk }}/{% else %}javascript:void(0){% endif %}" class="comment-btn {{ article.comment_set.count|yesno:'all-comments,btn-disabled'}}">所有评论</a>
                        </div>
                    </div>
                </div>
            </div>
            {% if article.comment_set.count %}
			<ul>
                {% for item in article.comment_set.all|slice:5 %}
				<li class="comment-item">
                    <div class="c-avatar">
                        <img src="{{ MEDIA_URL|add:'frontend/avatar/'|add:item.user.face }}" alt="" class="avatar" />
                    </div>
                    <div class="c-main">
                        <div>{{ item.content }}</div>
                        <div class="c-meta">
                            <span class="c-author">{{ item.user.username }}</span>
                            <span>{{ item.created_at|date:'Y-m-d H:i' }}</span>
                        </div>
                    </div>
                </li> 
                {% endfor %} 
			</ul>
            {% endif %}
		</div>
    </main>
    {% include 'frontend/include/footer.html'%}
    <script src="{% static 'frontend/scripts/jquery-3.7.0.min.js' %}"></script>
    <script>
        //根据当前文章评论的数量来决定显示哪个按钮
        /*
        if(!!{{ article.comment_set.count }}){
            $('#button1').show()
            $('#button2').hide()
        } else {
            $('#button1').hide()
            $('#button2').show()
        }
        */
    </script>
</body>
</html>