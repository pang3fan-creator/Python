# redis-cli

```mysql
sadd friends:user1 沧海 莎莉 圣女果
sadd friends:user2 刘兆 刀锋 秋天
sadd tag:pc 1001 1002 1003 1004
sadd tag:game 1001 1002 1003 1004
```

```mysql
ZADD audience1 8.2 singer1 8.5 singer2 9.0 singer3
ZADD audience2 8.5 singer1 8.3 singer2 8.8 singer3
ZADD judger1 7.8 singer1 8.3 singer2 8.8 singer3
ZADD judger2 8.1 singer1 7.6 singer2 8.9 singer3

ZINTERSTORE ranks 4 audience1 audience2 judger1 judger2 WEIGHTS 1 1 2 2 AGGREGATE SUM
zrange ranks 0 3 
```

<b>复习已完成</b>

# redis之python

```python
import redis as r

redis_conn = r.Redis(host='127.0.0.1', port=6379, db=0, password=None, decode_responses=True)  # 创建Redis连接

keys = redis_conn.keys(pattern='*')  # 获取所有键

for item in keys:
    key_type = redis_conn.type(item)  # 获取键的类型

    if key_type == 'string':
        value = redis_conn.get(item)  # 获取字符串值
    elif key_type == 'list':
        value = redis_conn.lrange(item, 0, -1)  # 获取列表值
    elif key_type == 'set':
        value = redis_conn.smembers(item)  # 获取集合值
    elif key_type == 'zset':
        value = redis_conn.zrange(item, 0, -1, withscores=True)  # 获取有序集合值
    else:
        value = redis_conn.hgetall(item)  # 获取哈希值

    print(f"Key: {item}, Type: {key_type}, Value: {value}, TTL: {redis_conn.ttl(item)}")

# for item in keys:
#     redis_conn.delete(item)
```

```python
import json
from redis import Redis

redis_conn = Redis(host='127.0.0.1', port=6379, password=None, decode_responses=True, db=0)

pipe = redis_conn.pipeline()
pipe.hset('buyer_tarena1', 1, '{"number":3,"price":1249.50,"status":false}')
pipe.hset('buyer_tarena1', 2, '{"number":3,"price":1249.50,"status":true}')
pipe.hset('buyer_tarena1', 3, '{"number":3,"price":1249.50,"status":false}')
pipe.hset('buyer_tarena1', 4, '{"number":3,"price":1249.50,"status":true}')
pipe.execute()

product_item = redis_conn.hgetall('buyer_tarena1')
print(product_item)

for k, v in product_item.items():
    a = json.loads(v)  # json.loads()的作用：将json字符串转换成python对象
    if not a['status']:
        a['status'] = True
        redis_conn.hset('buyer_tarena1', k, json.dumps(a))  # json.dumps()的作用：将python对象转换成json字符串

product_item = redis_conn.hgetall('buyer_tarena1')
print(product_item)
```

